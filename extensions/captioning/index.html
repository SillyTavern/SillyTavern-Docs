<!DOCTYPE html>
<html lang="en" class="h-full">
<head>
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-0NTJMWH0TW1"></script>
    <script data-cfasync="false">window.dataLayer = window.dataLayer || [];function gtag(){dataLayer.push(arguments);}gtag('js', new Date());gtag('config', 'G-0NTJMWH0TW1');</script>

    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <meta name="turbo-cache-control" content="no-cache" data-turbo-track="reload" data-track-token="3.11.0.805920984313">

    <!-- See retype.com -->
    <meta name="generator" content="Retype 3.11.0">

    <!-- Primary Meta Tags -->
    <title>Image Captioning | docs.ST.app</title>
    <meta name="title" content="Image Captioning | docs.ST.app">
    <meta name="description" content="Image Captioning allows SillyTavern to automatically generate text descriptions for images used in chats.">

    <!-- Canonical -->
    <link rel="canonical" href="https://docs.sillytavern.app/extensions/captioning/">

    <!-- Open Graph / Facebook -->
    <meta property="og:type" content="website">
    <meta property="og:url" content="https://docs.sillytavern.app/extensions/captioning/">
    <meta property="og:title" content="Image Captioning | docs.ST.app">
    <meta property="og:description" content="Image Captioning allows SillyTavern to automatically generate text descriptions for images used in chats.">

    <!-- Twitter -->
    <meta property="twitter:card" content="summary_large_image">
    <meta property="twitter:url" content="https://docs.sillytavern.app/extensions/captioning/">
    <meta property="twitter:title" content="Image Captioning | docs.ST.app">
    <meta property="twitter:description" content="Image Captioning allows SillyTavern to automatically generate text descriptions for images used in chats.">

    <script data-cfasync="false">(function(){var cl=document.documentElement.classList,ls=localStorage.getItem("retype_scheme"),hd=cl.contains("dark"),hl=cl.contains("light"),wm=window.matchMedia&&window.matchMedia("(prefers-color-scheme: dark)").matches;if(ls==="dark"||(!ls&&wm&&!hd&&!hl)){cl.remove("light");cl.add("dark")}else if(ls==="light"||(!ls&&!wm&&!hd&&!hl)){cl.remove("dark");cl.add("light")}})();</script>

    <link href="../../resources/css/retype.css?v=3.11.0.805920984313" rel="stylesheet">

    <script data-cfasync="false" src="../../resources/js/config.js?v=3.11.0.805920984313" data-turbo-eval="false" defer></script>
    <script data-cfasync="false" src="../../resources/js/retype.js?v=3.11.0" data-turbo-eval="false" defer></script>
    <script id="lunr-js" data-cfasync="false" src="../../resources/js/lunr.js?v=3.11.0.805920984313" data-turbo-eval="false" defer></script>
    <script id="prism-js" data-cfasync="false" src="../../resources/js/prism.js?v=3.11.0.805920984313" defer></script>

    <style>
        a {
            color: brown !important;
        }

        .dark a {
            color: rgb(223, 151, 18) !important;
        }

        body {
            font-family: Noto Sans, sans-serif;
        }

        .callout {
            padding: 1rem;
            margin-bottom: 1rem;
            border: 1px solid #d2d6dc;
            border-radius: 0.375rem;
        }

        .callout p {
            margin-bottom: 0.5rem !important;
            overflow: hidden;
        }

        .callout p:last-child {
            margin-bottom: 0 !important;
        }

        .callout .fa-fw {
            margin: 1rem 0.5rem 1rem 0;
            color: slategrey;
        }

        .docs-markdown .codeblock code,
        .docs-markdown .codeblock pre {
            white-space: pre-wrap;
        }
    </style>
    <link href="/static/webfonts/NotoSans/stylesheet.css" rel="stylesheet" />
    <link href="/static/css/fontawesome.min.css" rel="stylesheet" />
    <link href="/static/css/solid.min.css" rel="stylesheet" />
    <link href="/static/css/brands.min.css" rel="stylesheet" />

</head>
<body>
    <div id="retype-app" class="relative text-base antialiased text-base-text bg-base-bg font-body">
        <div class="absolute bottom-0 left-0" style="top: 5rem; right: 50%"></div>
    
        <header id="retype-header" class="sticky top-0 z-30 flex w-full h-16 bg-header-bg border-b border-header-border md:h-20">
            <div class="container relative flex items-center justify-between pr-6 grow md:justify-start">
                <!-- Mobile menu button skeleton -->
                <button v-cloak class="skeleton retype-mobile-menu-button flex items-center justify-center shrink-0 overflow-hidden dark:text-white focus:outline-none rounded-full w-10 h-10 ml-3.5 md:hidden"><svg xmlns="http://www.w3.org/2000/svg" class="mb-px shrink-0" width="24" height="24" viewBox="0 0 24 24" role="presentation" style="margin-bottom: 0px;"><g fill="currentColor"><path d="M2 4h20v2H2zM2 11h20v2H2zM2 18h20v2H2z"></path></g></svg></button>
                <div v-cloak id="retype-sidebar-left-toggle-button"></div>
        
                <!-- Logo -->
                <div class="flex items-center justify-between h-full py-2 md:w-75">
                    <div class="flex items-center px-2 md:px-6">
                        <a id="retype-branding-logo" href="../../" class="flex items-center leading-snug text-xl">
                            <span class="w-10 mr-2 grow-0 shrink-0 overflow-hidden">
                                <img class="max-h-10 dark:hidden md:inline-block" src="../../static/logo.png">
                                <img class="max-h-10 hidden dark:inline-block" src="../../static/logo.png">
                            </span>
                            <span class="dark:text-white font-bold line-clamp-1 md:line-clamp-2">SillyTavern Documentation</span>
                        </a>
                    </div>
        
                    <span class="hidden h-8 border-r md:inline-block border-base-border"></span>
                </div>
        
                <div class="flex justify-between md:grow">
                    <!-- Top Nav -->
                    <nav id="retype-header-nav" class="hidden md:flex">
                        <ul class="flex flex-col mb-4 md:pl-16 md:mb-0 md:flex-row md:items-center">
                            <li class="mr-6">
                                <a class="py-2 md:mb-0 inline-flex items-center text-sm whitespace-nowrap transition-colors duration-200 ease-linear md:text-header-text font-header-text-weight hover:text-header-text-hover" href="https://github.com/SillyTavern/SillyTavern">GitHub</a>
                            </li>
                            <li class="mr-6">
                                <a class="py-2 md:mb-0 inline-flex items-center text-sm whitespace-nowrap transition-colors duration-200 ease-linear md:text-header-text font-header-text-weight hover:text-header-text-hover" href="https://discord.gg/sillytavern">Discord</a>
                            </li>
                            <li class="mr-6">
                                <a class="py-2 md:mb-0 inline-flex items-center text-sm whitespace-nowrap transition-colors duration-200 ease-linear md:text-header-text font-header-text-weight hover:text-header-text-hover" href="https://www.reddit.com/r/SillyTavernAI/">Reddit</a>
                            </li>
        
                        </ul>
                    </nav>
        
                    <!-- Header Right Skeleton -->
                    <div v-cloak class="flex justify-end grow skeleton">
        
                        <!-- Search input mock -->
                        <div class="relative hidden w-40 lg:block lg:max-w-sm lg:ml-auto">
                            <div class="absolute flex items-center justify-center h-full pl-3 dark:text-dark-300">
                                <svg xmlns="http://www.w3.org/2000/svg" class="icon-base" width="16" height="16" viewBox="0 0 24 24" aria-labelledby="icon" role="presentation" style="margin-bottom: 1px;"><g fill="currentColor" ><path d="M21.71 20.29l-3.68-3.68A8.963 8.963 0 0020 11c0-4.96-4.04-9-9-9s-9 4.04-9 9 4.04 9 9 9c2.12 0 4.07-.74 5.61-1.97l3.68 3.68c.2.19.45.29.71.29s.51-.1.71-.29c.39-.39.39-1.03 0-1.42zM4 11c0-3.86 3.14-7 7-7s7 3.14 7 7c0 1.92-.78 3.66-2.04 4.93-.01.01-.02.01-.02.01-.01.01-.01.01-.01.02A6.98 6.98 0 0111 18c-3.86 0-7-3.14-7-7z" ></path></g></svg>
                            </div>
                            <input class="w-full h-10 placeholder-search-placeholder transition-colors duration-200 ease-in bg-search-bg border border-transparent rounded md:text-sm hover:border-search-border-hover focus:outline-none focus:border-search-border-focus" style="padding: 0.625rem 0.75rem 0.625rem 2rem" type="text" placeholder="Search">
                        </div>
        
                        <!-- Mobile search button -->
                        <div class="flex items-center justify-center w-10 h-10 lg:hidden">
                            <svg xmlns="http://www.w3.org/2000/svg" class="shrink-0 icon-base" width="20" height="20" viewBox="0 0 24 24" aria-labelledby="icon" role="presentation" style="margin-bottom: 0px;"><g fill="currentColor" ><path d="M21.71 20.29l-3.68-3.68A8.963 8.963 0 0020 11c0-4.96-4.04-9-9-9s-9 4.04-9 9 4.04 9 9 9c2.12 0 4.07-.74 5.61-1.97l3.68 3.68c.2.19.45.29.71.29s.51-.1.71-.29c.39-.39.39-1.03 0-1.42zM4 11c0-3.86 3.14-7 7-7s7 3.14 7 7c0 1.92-.78 3.66-2.04 4.93-.01.01-.02.01-.02.01-.01.01-.01.01-.01.02A6.98 6.98 0 0111 18c-3.86 0-7-3.14-7-7z" ></path></g></svg>
                        </div>
        
                        <!-- Dark mode switch placeholder -->
                        <div class="w-10 h-10 lg:ml-2"></div>
        
                        <!-- History button -->
                        <div class="flex items-center justify-center w-10 h-10" style="margin-right: -0.625rem;">
                            <svg xmlns="http://www.w3.org/2000/svg" class="shrink-0 icon-base" width="22" height="22" viewBox="0 0 24 24" aria-labelledby="icon" role="presentation" style="margin-bottom: 0px;"><g fill="currentColor" ><g ><path d="M12.01 6.01c-.55 0-1 .45-1 1V12a1 1 0 00.4.8l3 2.22a.985.985 0 001.39-.2.996.996 0 00-.21-1.4l-2.6-1.92V7.01c.02-.55-.43-1-.98-1z"></path><path d="M12.01 1.91c-5.33 0-9.69 4.16-10.05 9.4l-.29-.26a.997.997 0 10-1.34 1.48l1.97 1.79c.19.17.43.26.67.26s.48-.09.67-.26l1.97-1.79a.997.997 0 10-1.34-1.48l-.31.28c.34-4.14 3.82-7.41 8.05-7.41 4.46 0 8.08 3.63 8.08 8.09s-3.63 8.08-8.08 8.08c-2.18 0-4.22-.85-5.75-2.4a.996.996 0 10-1.42 1.4 10.02 10.02 0 007.17 2.99c5.56 0 10.08-4.52 10.08-10.08.01-5.56-4.52-10.09-10.08-10.09z"></path></g></g></svg>
                        </div>
                    </div>
        
                    <div v-cloak class="flex justify-end grow">
                        <div id="retype-mobile-search-button"></div>
                        <doc-search-desktop></doc-search-desktop>
        
                        <doc-theme-switch class="lg:ml-2"></doc-theme-switch>
                        <doc-history></doc-history>
                    </div>
                </div>
            </div>
        </header>
    
    
        <div id="retype-container" class="container relative flex bg-white">
            <!-- Sidebar Skeleton -->
            <div v-cloak class="fixed flex flex-col shrink-0 duration-300 ease-in-out bg-sidebar-left-bg border-sidebar-left-border sidebar top-20 w-75 border-r h-screen md:sticky transition-transform skeleton">
            
                <div class="flex items-center h-16 px-6">
                    <input class="w-full h-8 px-3 py-2 transition-colors duration-200 ease-linear bg-filter-bg border border-filter-border rounded shadow-none text-sm focus:outline-none focus:border-filter-border-focus" type="text" placeholder="Filter">
                </div>
            
                <div class="pl-6 mt-1 mb-4">
                    <div class="w-32 h-3 mb-4 bg-skeleton-bg rounded-full loading"></div>
                    <div class="w-48 h-3 mb-4 bg-skeleton-bg rounded-full loading"></div>
                    <div class="w-40 h-3 mb-4 bg-skeleton-bg rounded-full loading"></div>
                    <div class="w-32 h-3 mb-4 bg-skeleton-bg rounded-full loading"></div>
                    <div class="w-48 h-3 mb-4 bg-skeleton-bg rounded-full loading"></div>
                    <div class="w-40 h-3 mb-4 bg-skeleton-bg rounded-full loading"></div>
                </div>
            
                <div class="shrink-0 mt-auto bg-transparent dark:border-base-border">
                    <a class="flex items-center justify-center flex-nowrap h-16 text-gray-350 dark:text-dark-400 hover:text-gray-600 dark:hover:text-dark-300 transition-colors duration-150 ease-in docs-powered-by" target="_blank" href="https://retype.com/" rel="noopener">
                        <span class="text-xs whitespace-nowrap">Powered by</span>
                        <svg xmlns="http://www.w3.org/2000/svg" class="ml-2" fill="currentColor" width="96" height="20" overflow="visible"><path d="M0 0v20h13.59V0H0zm11.15 17.54H2.44V2.46h8.71v15.08zM15.8 20h2.44V4.67L15.8 2.22zM20.45 6.89V20h2.44V9.34z"/><g><path d="M40.16 8.44c0 1.49-.59 2.45-1.75 2.88l2.34 3.32h-2.53l-2.04-2.96h-1.43v2.96h-2.06V5.36h3.5c1.43 0 2.46.24 3.07.73s.9 1.27.9 2.35zm-2.48 1.1c.26-.23.38-.59.38-1.09 0-.5-.13-.84-.4-1.03s-.73-.28-1.39-.28h-1.54v2.75h1.5c.72 0 1.2-.12 1.45-.35zM51.56 5.36V7.2h-4.59v1.91h4.13v1.76h-4.13v1.92h4.74v1.83h-6.79V5.36h6.64zM60.09 7.15v7.48h-2.06V7.15h-2.61V5.36h7.28v1.79h-2.61zM70.81 14.64h-2.06v-3.66l-3.19-5.61h2.23l1.99 3.45 1.99-3.45H74l-3.19 5.61v3.66zM83.99 6.19c.65.55.97 1.4.97 2.55s-.33 1.98-1 2.51-1.68.8-3.04.8h-1.23v2.59h-2.06V5.36h3.26c1.42 0 2.45.28 3.1.83zm-1.51 3.65c.25-.28.37-.69.37-1.22s-.16-.92-.48-1.14c-.32-.23-.82-.34-1.5-.34H79.7v3.12h1.38c.68 0 1.15-.14 1.4-.42zM95.85 5.36V7.2h-4.59v1.91h4.13v1.76h-4.13v1.92H96v1.83h-6.79V5.36h6.64z"/></g></svg>
                    </a>
                </div>
            </div>
            
            <!-- Sidebar component -->
            <doc-sidebar v-cloak>
                <template #sidebar-footer>
                    <div class="shrink-0 mt-auto border-t md:bg-transparent md:border-none dark:border-base-border">
            
                        <div class="py-3 px-6 md:hidden border-b dark:border-base-border">
                            <nav>
                                <ul class="flex flex-wrap justify-center items-center">
                                    <li class="mr-6">
                                        <a class="block py-1 inline-flex items-center text-sm whitespace-nowrap transition-colors duration-200 ease-linear md:text-header-text font-header-text-weight hover:text-header-text-hover" href="https://github.com/SillyTavern/SillyTavern">GitHub</a>
                                    </li>
                                    <li class="mr-6">
                                        <a class="block py-1 inline-flex items-center text-sm whitespace-nowrap transition-colors duration-200 ease-linear md:text-header-text font-header-text-weight hover:text-header-text-hover" href="https://discord.gg/sillytavern">Discord</a>
                                    </li>
                                    <li class="mr-6">
                                        <a class="block py-1 inline-flex items-center text-sm whitespace-nowrap transition-colors duration-200 ease-linear md:text-header-text font-header-text-weight hover:text-header-text-hover" href="https://www.reddit.com/r/SillyTavernAI/">Reddit</a>
                                    </li>
            
                                </ul>
                            </nav>
                        </div>
            
                        <a class="flex items-center justify-center flex-nowrap h-16 text-gray-350 dark:text-dark-400 hover:text-gray-600 dark:hover:text-dark-300 transition-colors duration-150 ease-in docs-powered-by" target="_blank" href="https://retype.com/" rel="noopener">
                            <span class="text-xs whitespace-nowrap">Powered by</span>
                            <svg xmlns="http://www.w3.org/2000/svg" class="ml-2" fill="currentColor" width="96" height="20" overflow="visible"><path d="M0 0v20h13.59V0H0zm11.15 17.54H2.44V2.46h8.71v15.08zM15.8 20h2.44V4.67L15.8 2.22zM20.45 6.89V20h2.44V9.34z"/><g><path d="M40.16 8.44c0 1.49-.59 2.45-1.75 2.88l2.34 3.32h-2.53l-2.04-2.96h-1.43v2.96h-2.06V5.36h3.5c1.43 0 2.46.24 3.07.73s.9 1.27.9 2.35zm-2.48 1.1c.26-.23.38-.59.38-1.09 0-.5-.13-.84-.4-1.03s-.73-.28-1.39-.28h-1.54v2.75h1.5c.72 0 1.2-.12 1.45-.35zM51.56 5.36V7.2h-4.59v1.91h4.13v1.76h-4.13v1.92h4.74v1.83h-6.79V5.36h6.64zM60.09 7.15v7.48h-2.06V7.15h-2.61V5.36h7.28v1.79h-2.61zM70.81 14.64h-2.06v-3.66l-3.19-5.61h2.23l1.99 3.45 1.99-3.45H74l-3.19 5.61v3.66zM83.99 6.19c.65.55.97 1.4.97 2.55s-.33 1.98-1 2.51-1.68.8-3.04.8h-1.23v2.59h-2.06V5.36h3.26c1.42 0 2.45.28 3.1.83zm-1.51 3.65c.25-.28.37-.69.37-1.22s-.16-.92-.48-1.14c-.32-.23-.82-.34-1.5-.34H79.7v3.12h1.38c.68 0 1.15-.14 1.4-.42zM95.85 5.36V7.2h-4.59v1.91h4.13v1.76h-4.13v1.92H96v1.83h-6.79V5.36h6.64z"/></g></svg>
                        </a>
                    </div>
                </template>
            </doc-sidebar>
    
            <div class="grow min-w-0 bg-body-bg">
                <!-- Render "toolbar" template here on api pages --><!-- Render page content -->
                <div class="flex">
                    <div id="retype-main" class="min-w-0 p-4 grow md:px-16">
                        <main class="relative pb-12 lg:pt-2">
                            <div class="retype-markdown" id="retype-content">
                                <!-- Rendered if sidebar right is enabled -->
                                <div id="retype-sidebar-right-toggle"></div>
                                <!-- Page content  -->
<doc-anchor-target id="image-captioning" class="break-words">
    <h1>
        <doc-anchor-trigger class="header-anchor-trigger" to="#image-captioning">#</doc-anchor-trigger>
        <span>Image Captioning</span>
    </h1>
</doc-anchor-target>
<p>Image Captioning allows SillyTavern to automatically generate text descriptions for images used in chats.</p>
<p>Use Image Captioning when you want your AI character to &quot;see&quot; and respond to visual content in your conversations.</p>
<ul>
<li>Create captions for images you upload or paste into messages</li>
<li>Add context to existing images in the chat history</li>
<li>Use various sources for generation, including local models, cloud APIs, and crowdsourced networks</li>
</ul>
<p>There are options that require no setup, no money, and no GPU. There are also options that require some or all of those things. Choose the one that fits your needs and resources.</p>
<p>The image captioning extension is built-in to SillyTavern and does not need to be installed separately.</p>
<doc-anchor-target id="quick-start">
    <h2>
        <doc-anchor-trigger class="header-anchor-trigger" to="#quick-start">#</doc-anchor-trigger>
        <span>Quick start</span>
    </h2>
</doc-anchor-target>
<ol>
<li>Set up:
<ul>
<li>Open the <strong>Image Captioning</strong> panel in the <strong><i class="fa-solid fa-cubes"></i> Extensions</strong> panel</li>
<li>Choose a captioning source (most likely &quot;Local&quot; or &quot;Multimodal&quot;)</li>
<li>For &quot;Multimodal&quot; ensure you&#x27;ve set up the connection in the <strong><i class="fa-solid fa-plug"></i> API Connections</strong> tab</li>
</ul>
</li>
<li>Generate a caption:
<ul>
<li>Choose &quot;<strong>Generate Caption</strong>&quot; from the <strong><i class="fa-solid fa-magic-wand-sparkles"></i> Extensions</strong> popup menu</li>
<li>Select an image file when prompted</li>
<li>Wait for the caption to be generated</li>
</ul>
</li>
<li>Review and send:
<ul>
<li>The captioned image will be inserted into your message</li>
<li>See the caption using the image tooltip</li>
<li>Click <strong><i class="fa-solid fa-paper-plane"></i> Send</strong> to see what your character thinks of the image!</li>
</ul>
</li>
</ol>
<doc-anchor-target id="panel-controls">
    <h2>
        <doc-anchor-trigger class="header-anchor-trigger" to="#panel-controls">#</doc-anchor-trigger>
        <span>Panel controls</span>
    </h2>
</doc-anchor-target>
<doc-anchor-target id="source-selection">
    <h3>
        <doc-anchor-trigger class="header-anchor-trigger" to="#source-selection">#</doc-anchor-trigger>
        <span>Source Selection</span>
    </h3>
</doc-anchor-target>
<p>Choose the source for image captioning. Supported options:</p>
<div class="table-wrapper scrollbar overflow-hidden">
<table class="comfortable">
<thead>
<tr>
<th>Source</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><doc-anchor-trigger to="#multimodal-source">Multimodal</doc-anchor-trigger></td>
<td><strong>Cloud</strong>: OpenAI, Anthropic, Google, MistralAI, and others. <br><strong>Local</strong>: Ollama, llama.cpp, KoboldCpp, Text Generation WebUI, and vLLM. <br>Supports custom prompts so you can ask your images questions.</td>
</tr>
<tr>
<td><doc-anchor-trigger to="#local-source">Local</doc-anchor-trigger></td>
<td>Uses <a href="https://huggingface.co/docs/transformers.js/en/index">transformers.js</a> running locally inside your SillyTavern server. Zero setup!</td>
</tr>
<tr>
<td>Horde</td>
<td>Uses the <a href="https://aihorde.net/">AI Horde</a> network, a crowdsourced distributed network of image generation models. Nothing to download, configure, or pay for. Variable response times.</td>
</tr>
<tr>
<td>Extras</td>
<td>The Extras project was discontinued in April 2024 and is not maintained or supported.</td>
</tr>
</tbody>
</table>
</div>
<doc-anchor-target id="caption-configuration">
    <h3>
        <doc-anchor-trigger class="header-anchor-trigger" to="#caption-configuration">#</doc-anchor-trigger>
        <span>Caption Configuration</span>
    </h3>
</doc-anchor-target>
<ul>
<li><strong>Caption Prompt</strong>: Enter a custom prompt for captioning. The default prompt is &quot;What&#x27;s in this image?&quot;</li>
<li><strong>Ask every time</strong>: Toggle to request a custom prompt for each image caption</li>
</ul>
<doc-anchor-target id="message-template">
    <h3>
        <doc-anchor-trigger class="header-anchor-trigger" to="#message-template">#</doc-anchor-trigger>
        <span>Message Template</span>
    </h3>
</doc-anchor-target>
<ul>
<li><strong>Message Template</strong>: Customize the caption message template. Use <code v-pre>{{caption}}</code> macro to insert the generated caption. The default template is <code v-pre>[{{user}} sends {{char}} a picture that contains: {{caption}}]</code></li>
</ul>
<doc-anchor-target id="auto-captioning">
    <h3>
        <doc-anchor-trigger class="header-anchor-trigger" to="#auto-captioning">#</doc-anchor-trigger>
        <span>Auto-captioning</span>
    </h3>
</doc-anchor-target>
<ul>
<li><strong>Automatically caption images</strong>: Toggle to enable automatic captioning of images pasted or attached to messages</li>
<li><strong>Edit captions before saving</strong>: Toggle to allow editing captions before they are saved</li>
</ul>
<doc-anchor-target id="captioning-images">
    <h2>
        <doc-anchor-trigger class="header-anchor-trigger" to="#captioning-images">#</doc-anchor-trigger>
        <span>Captioning images</span>
    </h2>
</doc-anchor-target>
<p>All the ways to caption images in SillyTavern:</p>
<ul>
<li>Choose &quot;<strong>Generate Caption</strong>&quot; from the <strong><i class="fa-solid fa-magic-wand-sparkles"></i> Extensions</strong> popup menu and select an image file when prompted</li>
<li>Click the <i class="fa-solid fa-envelope-open-text"></i> <strong>Caption</strong> icon at the top of an image already in a message</li>
<li>Paste an image directly into the chat input with <doc-anchor-trigger to="#auto-captioning">auto-captioning</doc-anchor-trigger> enabled</li>
<li>Attach an image file to a message using the <i class="fa-solid fa-paperclip"></i> <strong>Embed File or Image</strong> button in the actions of a message.</li>
<li>Send a message with an embedded image</li>
<li>Use the <code v-pre>/caption</code> <doc-anchor-trigger to="#slash-command-caption">slash command</doc-anchor-trigger></li>
</ul>
<doc-anchor-target id="auto-captioning-1">
    <h2>
        <doc-anchor-trigger class="header-anchor-trigger" to="#auto-captioning-1">#</doc-anchor-trigger>
        <span>Auto-Captioning</span>
    </h2>
</doc-anchor-target>
<p>The auto-captioning feature allows you to automatically generate captions for images as they are added to the chat, without manually triggering the captioning process each time.</p>
<p>To enable, select the &quot;Automatically caption images&quot; checkbox in the Image Captioning panel. You can also choose to edit captions before they are saved by checking the &quot;Edit captions before saving&quot; box.</p>
<p>Once enabled, auto-captioning will trigger in the following scenarios:</p>
<ul>
<li>When an image is pasted directly into the chat input.</li>
<li>When an image file is attached to a message.</li>
<li>When a message with an embedded image is sent.</li>
</ul>
<p>The system will use your selected captioning source (Local, Extras, Horde, or Multimodal) and the configured settings to generate a caption for the image.</p>
<doc-anchor-target id="editing-captions-before-saving-refine-mode">
    <h3>
        <doc-anchor-trigger class="header-anchor-trigger" to="#editing-captions-before-saving-refine-mode">#</doc-anchor-trigger>
        <span>Editing captions before saving (Refine Mode)</span>
    </h3>
</doc-anchor-target>
<p>If you&#x27;ve enabled the &quot;Edit captions before saving&quot; option:</p>
<ol>
<li>After an image is added, a popup will appear with the generated caption.</li>
<li>You can review and edit the caption as needed.</li>
<li>Click &quot;OK&quot; to apply the caption, or &quot;Cancel&quot; to discard the caption without saving.</li>
</ol>
<doc-anchor-target id="caption-sending">
    <h3>
        <doc-anchor-trigger class="header-anchor-trigger" to="#caption-sending">#</doc-anchor-trigger>
        <span>Caption sending</span>
    </h3>
</doc-anchor-target>
<p>The generated (and optionally edited) caption will be automatically inserted into the prompt using the Message Template you&#x27;ve configured. By default, it will be sent in this format:</p>
<div class="codeblock-wrapper"><doc-codeblock>
<pre translate="no" class="language-none"><code v-pre class="language-none">[BaronVonUser sends Seraphina a picture that contains: ...]</code></pre>
</doc-codeblock></div>
<doc-anchor-target id="slash-command-caption">
    <h2>
        <doc-anchor-trigger class="header-anchor-trigger" to="#slash-command-caption">#</doc-anchor-trigger>
        <span>Slash Command: /caption</span>
    </h2>
</doc-anchor-target>
<p>The extension provides a <code v-pre>/caption</code> slash command to use in the chatbox or in scripts.</p>
<doc-anchor-target id="usage">
    <h3>
        <doc-anchor-trigger class="header-anchor-trigger" to="#usage">#</doc-anchor-trigger>
        <span>Usage</span>
    </h3>
</doc-anchor-target>
<div class="codeblock-wrapper"><doc-codeblock>
<pre translate="no" class="language-none"><code v-pre class="language-none">/caption [quiet=true|false]? [mesId=number]? [prompt]</code></pre>
</doc-codeblock></div>
<ul>
<li><code v-pre>prompt</code> (optional): A custom prompt for the captioning model. Only supported by multimodal sources.</li>
<li><code v-pre>quiet=true|false</code>: If set to true, suppresses sending a captioned message to the chat. Default is false.</li>
<li><code v-pre>mesId=number</code>: Specifies a message ID to caption an image from an existing message instead of uploading a new one.</li>
</ul>
<p>If no <code v-pre>mesId</code> is provided, the command will prompt you to upload an image. When <code v-pre>quiet</code> is false (default), a new message with the captioned image will be sent to the chat. The generated caption can be used as input for other commands.</p>
<doc-anchor-target id="examples">
    <h3>
        <doc-anchor-trigger class="header-anchor-trigger" to="#examples">#</doc-anchor-trigger>
        <span>Examples</span>
    </h3>
</doc-anchor-target>
<p>Caption a new image with the default settings:</p>
<div class="codeblock-wrapper"><doc-codeblock>
<pre translate="no" class="language-none"><code v-pre class="language-none">/caption</code></pre>
</doc-codeblock></div>
<p>Caption a new image with a custom prompt:</p>
<div class="codeblock-wrapper"><doc-codeblock>
<pre translate="no" class="language-none"><code v-pre class="language-none">/caption Describe the main colours and shapes in this image</code></pre>
</doc-codeblock></div>
<p>Caption an image from message #5 without sending a new message:</p>
<div class="codeblock-wrapper"><doc-codeblock>
<pre translate="no" class="language-none"><code v-pre class="language-none">/caption mesId=5 quiet=true</code></pre>
</doc-codeblock></div>
<p>Caption an image from message #10 with a custom prompt then <a href="../stable-diffusion/">generate a new image</a> based on the caption:</p>
<div class="codeblock-wrapper"><doc-codeblock>
<pre translate="no" class="language-none"><code v-pre class="language-none">/caption mesId=10 Describe this image using comma-separated keywords | /imagine </code></pre>
</doc-codeblock></div>
<doc-anchor-target id="local-source">
    <h2>
        <doc-anchor-trigger class="header-anchor-trigger" to="#local-source">#</doc-anchor-trigger>
        <span>Local source</span>
    </h2>
</doc-anchor-target>
<p>You can change the model in <a href="../../administration/config-yaml/#extensions-configuration">config.yaml</a>. The key is called <code v-pre>extensions.models.captioning</code>. Enter the Hugging Face model ID you want to use. The default is <code v-pre>Xenova/vit-gpt2-image-captioning</code>.</p>
<p>You can use any model that supports image captioning (<code v-pre>VisionEncoderDecoderModel</code> or &quot;image-to-text&quot; pipeline). The model needs be to compatible with the transformers.js library. That is, it needs ONNX weights. Look for models with the <code v-pre>ONNX</code> and <code v-pre>image-to-text</code> tags, or that have a folder called <code v-pre>onnx</code> full of <code v-pre>.onnx</code> files.</p>
<doc-anchor-target id="multimodal-source">
    <h2>
        <doc-anchor-trigger class="header-anchor-trigger" to="#multimodal-source">#</doc-anchor-trigger>
        <span>Multimodal source</span>
    </h2>
</doc-anchor-target>
<doc-anchor-target id="general-configuration">
    <h3>
        <doc-anchor-trigger class="header-anchor-trigger" to="#general-configuration">#</doc-anchor-trigger>
        <span>General configuration</span>
    </h3>
</doc-anchor-target>
<ul>
<li><strong>Model</strong>: Choose the model for image captioning. Options vary based on the selected API.</li>
<li><strong>Allow reverse proxy</strong>: Toggle to allow using a reverse proxy if defined and valid (OpenAI, Anthropic, Google, Mistral, xAI)</li>
</ul>
<p>API keys and endpoint URLs for captioning sources are managed in the <a href="../../usage/api-connections/">API Connections</a> panel. Set the connection up in API Connections first, then select it as your captions source in Captioning.</p>
<div class="flex mb-6">
    <div class="shrink-0 w-1.5 rounded-tl-lg rounded-bl-lg bg-callout-warning"></div>
    <div class="flex w-full py-4 border border-l-0 rounded-tr-lg rounded-br-lg doc-callout bg-callout-base-bg border-callout-base-border" role="alert">
        <div class="flex items-center ml-4 h-7">
            <svg xmlns="http://www.w3.org/2000/svg" class="mb-px text-callout-warning" width="22" height="22" viewBox="0 0 24 24" role="presentation">
                <g fill="currentColor"><g>
                    <path d="M22.48 15.59L14.01 1.45A2.968 2.968 0 0012.16.09c-.78-.19-1.58-.07-2.27.35-.41.25-.76.6-1.01 1.01v.01L.4 15.6c-.83 1.43-.33 3.27 1.1 4.1.45.26.95.4 1.48.4h16.95c.8-.01 1.55-.33 2.11-.9.56-.57.87-1.33.86-2.13a3.04 3.04 0 00-.42-1.48zm-1.87 2.21c-.19.19-.44.3-.69.3H2.99c-.17 0-.34-.05-.49-.13a.992.992 0 01-.37-1.35L10.6 2.48c.08-.14.2-.25.34-.33a.992.992 0 011.37.33l8.46 14.13c.09.15.13.32.13.49 0 .26-.1.51-.29.7z"></path>
                    <path d="M11.45 12.1c.55 0 1-.45 1-1v-4c0-.55-.45-1-1-1s-1 .45-1 1v4c0 .56.45 1 1 1zM11.46 14.1c-.56 0-1 .45-1 1s.45 1 1 1 1-.45 1-1-.45-1-1-1z"></path>
                </g></g>
            </svg>
        </div>
        <div class="pr-5 ml-3 w-full">
            <h5>Set it up in the API Connections panel first</h5>
<p>One last time: configure the API key/address/port in <strong><i class="fa-solid fa-plug"></i> API Connections</strong> and use the connection in Captioning.</p>
<p>You can still use Claude for chats and Google AI Studio for image captioning, or whatever. Just set them <em>both</em> up in the &#x27;API Connections&#x27; tab first. Then flip your Chat Completion source to Claude and your Captioning source to Google AI Studio.</p>
        </div>
    </div>
</div>
<p>For most local backends, you will need to set some options in the model backend rather than in SillyTavern. If your backend can only run one model at a time and doesn&#x27;t support automatic switching, you have several options to use different models for chat and captioning:</p>
<ol>
<li><strong>Secondary endpoints:</strong> Use the secondary endpoint feature (see <doc-anchor-trigger to="#secondary-endpoints">Secondary endpoints</doc-anchor-trigger> section below) to connect to a different API server for captioning</li>
<li><strong>Multiple connection types:</strong> Connect to your backend using both Text Completion and Chat Completion modes in API Connections - this gives you two separate connections to the same backend type</li>
</ol>
<doc-anchor-target id="sources">
    <h3>
        <doc-anchor-trigger class="header-anchor-trigger" to="#sources">#</doc-anchor-trigger>
        <span>Sources</span>
    </h3>
</doc-anchor-target>
<p>To use one of these caption sources, select Multimodal in the Source dropdown.</p>
<ul>
<li>&quot;I want the best captioning possible, and I don&#x27;t mind paying for it&quot;: Anthropic</li>
<li>&quot;I don&#x27;t want to pay anything or run anything&quot;: Google AI Studio free tier</li>
<li>&quot;I want to caption images locally and have it just work&quot;: Ollama</li>
<li>&quot;I want to keep the dream of local AI alive&quot;: <doc-anchor-trigger to="#koboldcpp">KoboldCpp</doc-anchor-trigger></li>
<li>&quot;I want to complain when it doesn&#x27;t work&quot;: <del>Extras</del></li>
</ul>
<div class="table-wrapper scrollbar overflow-hidden">
<table class="comfortable">
<thead>
<tr>
<th>API Provider</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>01.AI (Yi)</td>
<td>Cloud, paid, yi-vision</td>
</tr>
<tr>
<td>AI/ML API</td>
<td>Cloud, paid, various GPT, Claude, and Gemini models with vision capabilities</td>
</tr>
<tr>
<td>Anthropic</td>
<td>Cloud, paid, Claude models with vision capabilities: claude-3-5-sonnet/haiku, claude-3-opus/sonnet</td>
</tr>
<tr>
<td>Cohere</td>
<td>Cloud, paid, Aya Vision 8B / 32B</td>
</tr>
<tr>
<td>Custom (OpenAI-compatible)</td>
<td>For custom OpenAI-compatible APIs, uses currently configured model in API Connections tab</td>
</tr>
<tr>
<td>Google AI Studio</td>
<td>Cloud, free tier then paid, Gemini Flash/Pro</td>
</tr>
<tr>
<td>Google Vertex AI</td>
<td>Cloud, free tier, Gemini Flash/Pro</td>
</tr>
<tr>
<td>Groq</td>
<td>Cloud, llama-3.2-vision in 11B/90B, LLaVA</td>
</tr>
<tr>
<td>KoboldCpp</td>
<td>Local, must configure model in KoboldCpp</td>
</tr>
<tr>
<td>llama.cpp</td>
<td>Local, must configure model in llama.cpp</td>
</tr>
<tr>
<td>MistralAI</td>
<td>Cloud, paid, pixtral-large, pixtral-12B</td>
</tr>
<tr>
<td>Ollama</td>
<td>Local, can switch between available models and download <a href="https://ollama.com/search?c=vision">additional vision models</a> within Captioning after configuring in API Connections</td>
</tr>
<tr>
<td>OpenAI</td>
<td>Cloud, paid, GPT-4 Vision, 4-turbo, 4o, 4o-mini</td>
</tr>
<tr>
<td>OpenRouter</td>
<td>Cloud, paid (maybe free options), many models, pick from what&#x27;s available within Captioning after configuring in API connections</td>
</tr>
<tr>
<td>Pollinations</td>
<td>Cloud, free</td>
</tr>
<tr>
<td>Text Generation WebUI (oobabooga)</td>
<td>Local, must configure model in ooba</td>
</tr>
<tr>
<td>vLLM</td>
<td>Local</td>
</tr>
<tr>
<td>xAI (Grok)</td>
<td>Cloud, paid, grok-vision</td>
</tr>
</tbody>
</table>
</div>
<doc-anchor-target id="secondary-endpoints">
    <h3>
        <doc-anchor-trigger class="header-anchor-trigger" to="#secondary-endpoints">#</doc-anchor-trigger>
        <span>Secondary endpoints</span>
    </h3>
</doc-anchor-target>
<p>By default, the Multimodal source uses the primary endpoint configured in the API Connections tab.
You can also set up a secondary endpoint specifically for multimodal captioning.</p>
<ul>
<li>Open the <strong>Image Captioning</strong> panel in the <strong><i class="fa-solid fa-cubes"></i> Extensions</strong> panel.</li>
<li>Select &quot;Multimodal&quot; as the captioning source and a preferred API provider.</li>
<li>Enter a valid URL for the secondary endpoint in the &quot;Secondary captioning endpoint URL&quot; field.</li>
<li>Check the &quot;Use secondary URL&quot; box to enable the secondary endpoint.</li>
</ul>
<blockquote>
<p>Do not append <code v-pre>/v1</code> or <code v-pre>/chat/completions</code> to the end of the URL. The extension will handle that automatically.</p>
</blockquote>
<p>This is only supported by the following APIs:</p>
<ul>
<li>KoboldCpp</li>
<li>llama.cpp</li>
<li>Ollama</li>
<li>Text Generation WebUI (oobabooga)</li>
<li>vLLM</li>
</ul>
<doc-anchor-target id="source-specific-guides">
    <h3>
        <doc-anchor-trigger class="header-anchor-trigger" to="#source-specific-guides">#</doc-anchor-trigger>
        <span>Source-specific guides</span>
    </h3>
</doc-anchor-target>
<doc-anchor-target id="koboldcpp">
    <h4>
        <doc-anchor-trigger class="header-anchor-trigger" to="#koboldcpp">#</doc-anchor-trigger>
        <span>KoboldCpp</span>
    </h4>
</doc-anchor-target>
<p>For general information on installing and using <a href="https://github.com/LostRuins/koboldcpp">KoboldCpp</a>, see the <a href="https://github.com/LostRuins/koboldcpp/wiki">KoboldCpp documentation</a>.</p>
<p>To use KoboldCpp for multimodal captioning:</p>
<ul>
<li>get a multimodal-capable model, trained to process text and image prompts at the same time.</li>
<li>also get the multimodal projections for the model. These weights allow the model to understand how the text and image parts of the input relate to each other.</li>
<li>load the model and projections in the KoboldCpp launch GUI or command line interface.</li>
</ul>
<p>The original and classic local multimodal model is LLaVA. GGUF-format files for the model and projections are available from <a href="https://huggingface.co/Mozilla/llava-v1.5-7b-llamafile">Mozilla/llava-v1.5-7b-llamafile</a>. To load them from the command line, set the model and projections with the <code v-pre>--model</code> and <code v-pre>--mmproj</code> flags. For example:</p>
<div class="codeblock-wrapper"><doc-codeblock>
<pre translate="no" class="language-bash"><code v-pre class="language-bash">./koboldcpp \
--model=&quot;models/llava-v1.5-7b-Q4_K.gguf&quot; \
--mmproj=&quot;models/ llava-v1.5-7b-mmproj-Q4_0.gguf&quot; \
... other flags ...</code></pre>
</doc-codeblock></div>
<p>Some LLaVA finetunes you can try: <a href="https://huggingface.co/xtuner/llava-llama-3-8b-v1_1-gguf">xtuner/llava-llama-3-8b-v1_1-gguf</a>, <a href="https://huggingface.co/xtuner/llava-phi-3-mini-gguf">xtuner/llava-phi-3-mini-gguf</a>.</p>
<p>You can use multimodal projections for the base model that your particular finetune was built from. Projections for some common base models are available from <a href="https://huggingface.co/koboldcpp/mmproj/tree/main">koboldcpp/mmproj</a>.</p>

                                
                                <!-- Required only on API pages -->
                                <doc-toolbar-member-filter-no-results></doc-toolbar-member-filter-no-results>
                            </div>
                            <footer id="retype-content-footer" class="clear-both">
                                <div class="flex flex-wrap items-center justify-between mt-14">
                                    <a id="retype-edit-this-page" class="my-2.5 inline-flex items-center text-sm whitespace-nowrap text-body-link font-body-link-weight hover:text-body-link-hover hover:underline" href="https://github.com/SillyTavern/SillyTavern-Docs/edit/main/extensions/captioning.md" target="_blank" rel="noopener">
                                        <svg class="mr-1.5" xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="currentColor" overflow="visible"><path d="M20 12c-.55 0-1 .45-1 1v7c0 .55-.45 1-1 1H4c-.55 0-1-.45-1-1V6c0-.55.45-1 1-1h7c.55 0 1-.45 1-1s-.45-1-1-1H4C2.35 3 1 4.35 1 6v14c0 1.65 1.35 3 3 3h14c1.65 0 3-1.35 3-3v-7c0-.55-.45-1-1-1z" /><path d="M22.21 1.79c-1.18-1.18-3.24-1.18-4.41 0l-9.5 9.5c-.13.13-.22.29-.26.46l-1 4c-.08.34.01.7.26.95.18.2.44.3.7.3.08 0 .16-.01.24-.03l4-1c.18-.04.34-.13.46-.26l9.5-9.5c1.22-1.22 1.22-3.2.01-4.42zm-1.42 3l-9.3 9.3-2.11.53.53-2.11 9.3-9.3c.42-.42 1.16-.42 1.59 0 .43.43.43 1.15-.01 1.58z" /><path fill="none" d="M0 0h24v24H0z" /></svg>
                                        <span>Edit this page</span>
                                    </a>
                                </div>
                            
                                <nav id="retype-nextprev" class="print:hidden flex mt-14">
                                    <div class="w-1/2">
                                        <a class="px-5 py-4 h-full flex items-center break-normal font-medium text-body-link border border-base-border hover:border-base-border-hover rounded-l-lg transition-colors duration-150 relative hover:z-5" href="../../extensions/emulatorjs/">
                                            <svg xmlns="http://www.w3.org/2000/svg" class="mr-3" width="24" height="24" viewBox="0 0 24 24" fill="currentColor" overflow="visible"><path d="M19 11H7.41l5.29-5.29a.996.996 0 10-1.41-1.41l-7 7a1 1 0 000 1.42l7 7a1.024 1.024 0 001.42-.01.996.996 0 000-1.41L7.41 13H19c.55 0 1-.45 1-1s-.45-1-1-1z" /><path fill="none" d="M0 0h24v24H0z" /></svg>
                                            <span>
                                                <span class="block text-xs font-normal text-base-text-muted">Previous</span>
                                                <span class="block mt-1">Emulator​JS</span>
                                            </span>
                                        </a>
                                    </div>
                            
                                    <div class="w-1/2">
                                        <a class="px-5 py-4 -mx-px h-full flex items-center justify-end break-normal font-medium text-body-link border border-base-border hover:border-base-border-hover rounded-r-lg transition-colors duration-150 relative hover:z-5" href="../../extensions/stable-diffusion/">
                                            <span>
                                                <span class="block text-xs font-normal text-right text-base-text-muted">Next</span>
                                                <span class="block mt-1">Image Generation</span>
                                            </span>
                                            <svg xmlns="http://www.w3.org/2000/svg" class="ml-3" width="24" height="24" viewBox="0 0 24 24" fill="currentColor" overflow="visible"><path d="M19.92 12.38a1 1 0 00-.22-1.09l-7-7a.996.996 0 10-1.41 1.41l5.3 5.3H5c-.55 0-1 .45-1 1s.45 1 1 1h11.59l-5.29 5.29a.996.996 0 000 1.41c.19.2.44.3.7.3s.51-.1.71-.29l7-7c.09-.09.16-.21.21-.33z" /><path fill="none" d="M0 0h24v24H0z" /></svg>
                                        </a>
                                    </div>
                                </nav>
                            </footer>
                        </main>
                
                        <div id="retype-page-footer" class="print:border-none border-t border-base-border pt-6 mb-8">
                            <footer class="flex flex-wrap items-center justify-between print:justify-center">
                                <div id="retype-footer-links" class="print:hidden">
                                    <ul class="flex flex-wrap items-center text-sm">
                                    </ul>
                                </div>
                                <div id="retype-copyright" class="print:justify-center py-2 text-footer-text font-footer-link-weight text-sm leading-relaxed"><p>© Copyright 2025. All rights reserved.</p></div>
                            </footer>
                        </div>
                    </div>
                
                    <!-- Rendered if sidebar right is enabled -->
                    <!-- Sidebar right skeleton-->
                    <div v-cloak class="fixed top-0 bottom-0 right-0 translate-x-full bg-sidebar-right-bg border-sidebar-right-border lg:sticky lg:border-l lg:shrink-0 lg:pt-6 lg:transform-none sm:w-1/2 lg:w-64 lg:z-0 md:w-104 sidebar-right skeleton">
                        <div class="pl-5">
                            <div class="w-32 h-3 mb-4 bg-skeleton-bg rounded-full loading"></div>
                            <div class="w-48 h-3 mb-4 bg-skeleton-bg rounded-full loading"></div>
                            <div class="w-40 h-3 mb-4 bg-skeleton-bg rounded-full loading"></div>
                        </div>
                    </div>
                
                    <!-- User should be able to hide sidebar right -->
                    <doc-sidebar-right v-cloak></doc-sidebar-right>
                </div>

            </div>
        </div>
    
        <doc-search-mobile></doc-search-mobile>
        <doc-back-to-top></doc-back-to-top>
    </div>


    <div id="retype-overlay-target"></div>

    <script data-cfasync="false">window.__DOCS__ = { "title": "Image Captioning", level: 2, icon: "file", hasPrism: true, hasMermaid: false, hasMath: false, tocDepth: 23 }</script>
</body>
</html>
